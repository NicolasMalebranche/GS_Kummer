\section{Cohomology of Hilbert schemes of points on surfaces}

Let $A$ be a smooth projective complex surface. Set $H:=H^*(A,\Q)$. Let $A\hilb{n}$ the Hilbert scheme of $n$ points on the surface, \ie the moduli space of finite subschemes of $A$ of length $n$.
%$$\Hilb^ n : S \mapsto \left\{ Z\subset S\times A\,|\,Z\text{ closed subscheme, } p_1 : Z\rightarrow S \text{ flat and finite of degree }n\right\}.$$
$A\hilb{n}$ is again smooth and projective of dimension $2n$, cf.~\cite{Fogarty}. 
\subsection{The rational cohomology}
Their rational cohomology can be described in terms of Nakajima's \cite{Nakajima} operators. First consider the direct sum
$$
\H := \bigoplus_{n=0}^{\infty} H^*(A\hilb{n},\Q)
$$
This space is bigraded by cohomological \emph{degree} and the \emph{weight}, which is given by the number of points $n$. The unit element in $H^0(A\hilb{0},\Q) \cong \Q$ is denoted by $\vac$, called the \emph{vacuum}.
There are linear operators $\q_m(a)$, for each $m\geq 1$ and $a \in H^*(A,\Q)$, acting on $\H$ which have the following properties: They depend linearly on $a$, and if $a\in H^k(A,\Q)$ is homogeneous, the operator $\q_{m}(a)$ is bihomogeneous of degree $k+2(|m|-1)$ and weight $m$:
$$
\q_{m}(a) : H^l(A\hilb{n}) \rightarrow H^{l+k+2(|m|-1)}(A\hilb{n+m})
$$
To construct them, first define incidence varieties $Z_m\subset A\hilb{n}\times A\times A\hilb{n+m}$ by
$$
Z_m := \left\{(\xi,x,\xi')\, |\, \xi\subset\xi',\, \supp(\xi') -\supp(\xi) = mx \right\}.
$$
Then $\q_m(a)(\beta) $ is defined as the Poincar\'e dual of 
$$
pr_{3*}\left( \left(pr_2^*(\alpha)\cdot pr_3^*(\beta)\right) \cap [Z_m] \right).
$$
Every element in $\H$ can be decomposed uniquely as a linear combination of products of operators $\q_{m}(a)$, acting on the vacuum. 

To give the cup product structure of $\H$, define oprators $\G(a)$ for $a \in H^*(A)$. Let $\Xi_n \subset A\hilb{n}\times A$ be the universal subscheme. Then the action of $\G(a)$ on $H^*(A\hilb{n})$ is multiplication with the class
$$
pr_{1*}\left( \ch(\mathcal{O}_{\Xi_n})\cdot pr_2^*(\td(A)\cdot a) \right) \in H^*(A\hilb{n}).
$$
For $a \in H^k(A)$, we define $\G_i(a)$ to be the component of $\G(a)$ of cohomological degree $k+2i$. A differential operator $\mathfrak{d}$ is given by $\G_1(1)$. It means multiplication with the first Chern class of the tautological sheaf $pr_{1*}\left( \mathcal{O}_{\Xi_n}\right)$.

In \cite{LehnSorger} and \cite{LiQinWang} there are various commutation relations between these operators, that allow to determine all multiplications in the cohomology of the Hilbert scheme. First of all, if $X$ and $Y$ are operators of degree $d$ and $d'$, their commutator is defined as 
$$
[X,Y] := XY - (-1)^{dd'}YX.
$$
The integral on $A\hilb{n}$ induces a bilinar form on $\H$: for classes $\alpha,\,\beta\in H^*(A\hilb{n})$ it is given by
$$
(\alpha,\beta) \longmapsto \int_{A\hilb{n}}\alpha\cdot\beta.
$$
If $X$ is a homogeneous linear operator of degree $d$ and weight $m$, acting on $\H$, define its adjont $X^\dagger$ by
$$
\int_{A\hilb{n+m}}X(\alpha)\cdot\beta = (-1)^{d\deg(\alpha)}\int_{A\hilb{n}} \alpha \cdot X^\dagger (\beta).
$$
We put $\q_0(a) :=0$ and for $m<0$, $\q_m(a) := (-1)^m \q_{-m}(a)^\dagger$. Then define
$$
\mathfrak{L}_m(a) := \left\{ 
\begin{array}{ll}
 \tfrac{1}{2}\sum\limits_{k\in\Z}\sum\limits_{i}\q_k( a_{(1)})\q_{m-k}( a_{(2)}), & \text{ if } m\neq 0, \vspace{4mm}\\
 \sum\limits_{k>0}\sum\limits_{i}\q_k( a_{(1)})\q_{-k}( a_{(2)}), & \text{ if } m= 0. \\
\end{array}
\right.
$$
where $\sum_i a_{(1)}\otimes  a_{(2)}$ is the push-forward of $a$ along the diagonal $\tau_2 :A \rightarrow A\times A$ (in Sweedler notation).
Then we have (\cite[Thm.~2.16]{LiQinWang}):
\begin{align}
[\q_m(a), \q_l(b)] &= m\cdot \delta_{m+l} \cdot \int_A ab \\
[\mathfrak{L}_m(a),\q_l(b)] &= -m\cdot \q_{m+l}(ab) \\
\label{DiffNaka}
[\mathfrak{d},\q_m(a)] &= m \cdot \mathfrak{L}_m(a) + \tfrac{m(|m|-1)}{2} \q_m(K a) \\
[\G(a),\q_1(b)] &= \exp(\ad(\mathfrak{d}))(\q_1(a b) )
\end{align}
Note (cf.~\cite[Thm.~3.8]{LehnSorger}) that this implies that 
\begin{equation}\label{NakaDel}
\q_{m+1}(a) = \tfrac{(-1)^m}{m!}\ad^m([\mathfrak{d},\q_1(1)])(\q_1(a)),
\end{equation}
so there are two ways of writing an element of $\H$: As a linear combination of products of creation operators $\q_m(a)$ or as a linear combination of products of the operators $\mathfrak{d}$ and $\q_1(a)$. While the first one is more intuitive, the second one is more suitable for computing cup-products. 
Equations (\ref{DiffNaka}) and (\ref{NakaDel}) permit now to switch between the two representations, using that
\begin{gather}
\mathfrak{d} \vac = 0 ,  \\
\mathfrak{L}_m(a) \vac = \left\{ 
\begin{array}{cl}
 \tfrac{1}{2}\sum\limits_{k=1}^{m-1}\sum\limits_{i}\q_k(a_{(1)})\q_{m-k}(a_{(2)})\vac, & \text{ if } m>1, \vspace{4mm}\\
 0, & \text{ if } m\leq 1. \\
\end{array}
\right.\\
\end{gather}


\begin{remark}
We adopted the notation from \cite{LiQinWang}, which differs from the conventions in \cite{LehnSorger}. Here is part of a dictionary:

\begin{tabular}{c|c} 
Notation from \cite{LiQinWang} & Notation from \cite{LehnSorger} \\\hline
operator of bidegree $(w,d)$ & operator of bidegree $(w,d-2w)$\\
$\q_m(a) $ & $\p_{-m}(a)$ \\
$ \mathfrak{L}_m(a) $ & $ - L_{-m}(a)$ \\
$\mathfrak{G}(a)$ & $a\hilb{\bullet}$\\
$ \mathfrak{d} $ & $ \partial $ \\
$\tau_{2*}(a)$& $-\Delta(a)$
\end{tabular}
\end{remark}

By sending a subscheme in $A$ to is support, we define a morphism
$$
\rho : A\hilb{n} \longrightarrow \Sym^n(A),
$$
called the Hilbert--Chow morphism. The cohomology of $\Sym^n(A)$ is given by elements of the $n$-fold tensor power of $H^*(A)$ that are invariant under the action of the group of permutations $\mathfrak{S}_n$. A class in $H^*(A\hilb{n},\Q)$ which can be written using only the operators $\q_1$ comes from a pullback along $\rho$:
\begin{equation}
\label{qSym}
\q_1(b_1)\cdots \q_1(b_n)\vac = \rho^*\left( \sum_{\pi\in\mathfrak{S}_n } \pm b_{\pi(1)}\otimes\ldots\otimes b_{\pi(n)} \right), \quad b_i\in H^*(A,\Q),
\end{equation}
where signs arise from permuting factors of odd degrees. In particular,
\begin{gather} \label{q0primitive}
\frac{1}{n!}\q_1(b)^n \vac = \rho^*\big( b\otimes \ldots \otimes b\big),
\\ \label{q1primitive}
\frac{1}{(n-1)!}\q_1(b)\left(\q_1(1)\right)^{n-1}\vac =\rho^*\Big( b\otimes\! 1\!\otimes\ldots\otimes\! 1\; + \;\ldots\; +\; 1\!\otimes\ldots\otimes\! 1\! \otimes b\Big) .
\end{gather}
\begin{remark}
With the notation from Section \ref{SuperSection}, we have that
$$
H^*(\Sym^n(A),\Q) \cong \SSym^n(H^*(A,\Q)).
$$
Under this isomorphism the ring structure of $\SSym^n(H^*(A,\Q))$ corresponds to the cup product and the action of the operator $\q_1(a)$ corresponds to the operation $a\,\diamond$.
\end{remark}

\subsection{On integral cohomology}

For the study of integral cohomology, first note that if $\alpha \in H^*(A,\Z)$ is an integral class, then $\q_{m}(\alpha) $ maps integral classes to integral classes. 
Moreover, there is the following theorem:
\begin{theorem} \cite{QinWang}
An operator is called integral if it maps integral classes in $\H$ to integral classes. The operator $\frac{1}{z_\lambda}\kq_{\lambda}(1)$ is integral. Let $\alpha \in H^2(A,\Z)$ be monodromy equivalent to a divisor. Then the operator $\mathfrak{m}_{\lambda}(\alpha)$ is integral.
\end{theorem}


\begin{remark}
If $A$ is a projective torus, then the sublattice of divisors in $H^2(A,\Z)$ (the N\'eron--Severi group) is not trivial. By \cite[Thm.~II]{Shioda}, the group of monodromy actions spans the entire automorphism group of $H^2(A,\Z)$.
Since the lattice is even and contains two copies of the hyperbolic lattice, a theorem of Eichler \cite[Prop.~3.7.3]{Scattone} states that the automorphism group of $H^2(A,\Z)$ acts transitively on classes of the same norm. So every class can be mapped to a divisor by the action of a monodromy.
\end{remark}

We set $a^{(k)} := \mathfrak{G}_k(a) (1) \in H^{\deg a + 2k}(A\hilb{n},\Q)$.

\begin{remark}
Qin and Wang \cite{QinWang} conjecture that the above theorem is valid even without any restriction on $\alpha \in H^2(A,\Z)$. The following proposition explicits this out for low degrees.
\end{remark}
\begin{proposition} Assume that $H^*(A,\Z)$ is free of torsion.
Let $(a_i) \subset H^1(A,\Z)$ and $(b_i)\subset H^2(A,\Z)$ be bases of integral cohomology. Denote $a_i^*\in H^3(A,\Z)$ resp.~$b_i^*\in H^2(A,\Z)$ the elements of the dual bases. Let $x$ be the generator of $H^4(A,\Z)$. Then the classes
$\G_0(a_i)1 = \frac{1}{(n-1)!}\q_{1}(1)^{n-1}\q_{1}(a_{i})\vac$ form a basis of $H^1(A\hilb{n},\Z)$ with dual basis
$\q_1(a_i^*)\q_1(x)^{n-1}\vac$.
Moreover, the following classes form a basis of $H^2(A\hilb{n},\Z)$:
\begin{itemize}
 \item $\G_0(b_i)1=\frac{1}{(n-1)!}\q_{1}(1)^{n-1}\q_{1}(b_{i})\vac$,
 \item $\G_0(a_i)\G_0(a_j)1 = \frac{1}{(n-2)!}\q_{1}(1)^{n-2}\q_{1}(a_{i})\q_{1}(a_{j})\vac,\  i < j$,
 \item $\mathfrak{d} 1 =  \frac{1}{2(n-2)!}\q_{1}(1)^{n-2}\q_{2}(1) \vac$. We denote this class by $\delta$.
\end{itemize}
Their respective duals in $H^{2n-2}(A\hilb{n},\Z)$ are given by
\begin{itemize}
 \item $\q_{1}(b_{i}^*)\q_{1}(x)^{n-1}\vac$,
 \item $\q_{1}(a_{j}^*)\q_{1}(a_{i}^*)\q_{1}(x)^{n-2}\vac,\  i < j$,
 \item $\q_2(x)\q_{1}(x)^{n-2} \vac$.
\end{itemize}
\end{proposition}
\begin{proof} It is clear from the above theorem that these classes are all integral.
G\"ottsche's formula \cite[p.~35]{Gottsche} gives the Betti numbers of $A\hilb{n}$ in terms of the Betti numbers of $A$: 
$h^1(A\hilb{n}) = h^1(A)$, and $h^2(A\hilb{n}) = h^2(A)+ \frac{h^1(A)(h^1(A)-1)}{2} + 1$. It follows that we have not forgotten any classes. 

Next we have to show that the intersection matrix between these classes is in fact the identity matrix. Most of the entries can be computed easily using (\ref{qSym}). For products involving $\delta$ (this is the action of $\mathfrak{d}$) or its dual, first observe that $\mathfrak{d}\q_1(x)^m\vac = 0 $ and $ \mathfrak{L}_1(a)\q_1(x)^m\vac =0$ for every class $a$ of degree at least 1. Then compute:
\begin{gather*}
\delta \cdot\q_2(x)\q_{1}(x)^{n-2} \vac = \mathfrak{d}\q_2(x)\q_{1}(x)^{n-2} \vac = 2 \mathfrak{L}_2(x) \q_{1}(x)^{n-2} \vac = \q_{1}(x)^{n}\vac,
\\
\mathfrak{d}\q_{1}(b_{i}^*)\q_{1}(x)^{n-1}\vac =  \mathfrak{L}_1(b_i^*) \q_{1}(x)^{n-1} \vac = 0,
\\
\mathfrak{d}\q_{1}(a_{j}^*)\q_{1}(a_{i}^*)\q_{1}(x)^{n-2}\vac = \left(\mathfrak{L}_1(a_j^*) +\q_{1}(a_{j}^*)\mathfrak{d}\right)\q_{1}(a_{i}^*)\q_{1}(x)^{n-2}\vac = 
  \\ =\left(-\q_1(a_i^*)\mathfrak{L}_1(a_j^*) + \q_{1}(a_{j}^*)\mathfrak{L}_1(a_i^*)\right)\q_{1}(x)^{n-2}\vac  = 0,
\\
\G_0(b_i)\q_2(x)\q_{1}(x)^{n-2} \vac = 0, 
\\
\G_0(a_i)\G_0(a_j)\q_2(x)\q_{1}(x)^{n-2} \vac = 0.
\end{gather*}
\end{proof}

%The first $6$ classes give an injection $j : H^2(A,\Z)\rightarrow H^2(A\hilb{n},\Z)$. 

\begin{proposition}
 Let $A$ be a complex torus of dimension $2$. A basis of $H^*(A\hilb{2},\Z)$ is given by the classes 
 \begin{enumerate}\setcounter{enumi}{-1}
  \item $\frac{1}{2}\q_1(1)^2\vac$ ,
  \item $\q_1(1)\q_1(a_i)\vac$, for a basis $(a_i)\subset H^1(A,\Z)$,
  \item $\frac{1}{2}\q_2(1)\vac,\ \q_1(1)\q_1(u_i)\vac$ for a basis $(u_i)\subset H^2(A,\Z)$,
  \item $\q_2(a_i)\vac, \ \q_1(a_i)\q_1(u_j)\vac\ \q_1(1)\q_1(a^*_i)\vac$,
  \item $\q_2(u_i)\vac, \ \q_1(a_i)\q_1(a^*_j)\vac,\ \q_1(u_i)\q_1(u_k)\vac$ for $i\leq k$,
  \item $\frac{1}{2}\q_2(a^*_i)\vac, \ \q_1(a^*_i)\q_1(u_j)\vac,\ \q_1(x)\q_1(a_i)\vac$,
  \item $\q_2(x)\vac,\ \q_1(x)\q_1(u_i)\vac$,
  \item $\q_1(x)\q_1(a^*_i)\vac$, 
  \item $\q_1(x)^2\vac$.
 \end{enumerate}
\begin{proof}
One computes the intersection matrix of these objects under the Poincar\'e duality pairing and finds that the determinant is one. 
So it remains to show that all these classes are integral. By the analysis in \cite{QinWang} this is clear for all classes except 
those of the form $\frac{1}{2}\q_2(a^*_i)\vac \in H^5(A\hilb{2},\Z)$.

\end{proof}

\end{proposition}
