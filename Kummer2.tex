\documentclass{amsart}

\usepackage{amsmath,amssymb,amsfonts,amscd}
\usepackage[all]{xy}
\usepackage{appendix,listings,hyperref}

\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\trace}{tr}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\im}{Im}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Hilb}{Hilb}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\rk}{rk}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\td}{td}
\DeclareMathOperator{\supp}{supp}


\newcommand{\hilb}[1]{^{[#1]}}
\newcommand{\ie}{{\it i.e. }}
\newcommand{\eg}{{\it e.g. }}
\newcommand{\loccit}{{\it loc. cit. }}
\newcommand{\vac}{|0\rangle}
\newcommand{\odd}{{\rm{odd}}}
\newcommand{\even}{{\rm{even}}}
\newcommand{\tors}{{\rm{tors}}}

\newcommand{\p}{\mathfrak{p}}
\newcommand{\G}{\mathfrak{G}}
\newcommand{\q}{\mathfrak{q}}
\newcommand{\pone}{ \mathfrak{p}_{ - 1} }

\newcommand{\coloneqq}{:=}
\newcommand{\kum}[2]{K_{ #2 }( #1 )}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\C}{\mathbb{C}}
\renewcommand{\H}{\mathbb{H}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\kS}{\mathfrak{S}}

\newcommand{\km}{\mathfrak{m}}
\newcommand{\kq}{\mathfrak{q}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\lra}{\longrightarrow}
\newcommand{\ra}{\rightarrow}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title{Integral cohomology of $\kum{A}{2}$}


\author{Simon Kapfer}
\author{Gr\'egoire Menet}
%\address{Simon Kapfer, Laboratoire de Math\'ematiques et Applications, UMR CNRS 6086, Universit\'e de Poitiers, T\'el\'eport 2, Boulevard Marie et Pierre Curie, F-86962 Futuroscope Chasseneuil}
\address{Simon Kapfer, Institut f\"ur Mathematik, Universit\"at Augsburg, D--86159 Augsburg}
%\email{simon.kapfer@math.univ-poitiers.fr}
\email{simon.kapfer@math.uni-augsburg.de}
%\urladdr{http://www.math.uni-augsburg.de/alg/}


\date{\today}

%\keywords{}

\begin{abstract} 
What we know already
\end{abstract}

\maketitle

\section{Preliminaries}
\begin{definition}
Let $n$ be a natural number. A partition of $n$ is a decreasing sequence $\lambda = (\lambda_1,\ldots,\lambda_k),\ \lambda_1\geq\ldots\geq\lambda_k>0$ of natural numbers such that $\sum_i \lambda_i =n$. Sometimes it is convenient to write $\lambda = (\ldots,2^{m_2},1^{m_1})$ with multiplicities in the exponent.
We define the weight $\|\lambda\| :=\sum m_i i =n$ and the length $|\lambda| := \sum_i m_i =k$. 
We also define $z_\lambda \coloneqq\prod_i i^{m_i} m_i!$. 
\end{definition}
\begin{definition} \label{SymFun}
Let $\Lambda_n := \Q[x_1,\ldots,x_n]^{S_n}$ be the graded ring of symmetric polynomials. There are canonical projections $: \Lambda_{n+1}\rightarrow\Lambda_n$ which send $x_{n+1}$ to zero. The graded projective limit
$\Lambda:=\lim\limits_{\leftarrow}\Lambda_n$ is called the ring of symmetric functions.
Let $m_\lambda$ and $p_\lambda$ denote the monomial and the power sum symmetric functions. They are defined as follows: For a monomial $x_{i_1}^{\lambda_1}x_{i_2}^{\lambda_2}\ldots x_{i_k}^{\lambda_k}$ of total degree $n$, the (ordered) sequence of exponents $(\lambda_1,\ldots,\lambda_k)$ defines a partition $\lambda$ of $n$, which is called the shape of the monomial. Then we define $m_\lambda$ being the sum of all monomials of shape $\lambda$. 
For the power sums, first define $p_n := x_1^n + x_2^n + \ldots$. 
Then $p_\lambda := p_{\lambda_1}p_{\lambda_2}\ldots p_{\lambda_k}$.
The families $(m_\lambda)_\lambda$ and $(p_\lambda)_\lambda$ form two $\Q$-bases of $\Lambda$, so they are linearly related by $p_\lambda = \sum_{\mu} \psi_{\lambda\mu}m_\mu$. It turns out that the base change matrix $(\psi_{\lambda\mu})$ has integral entries, but its inverse $(\psi_{\lambda\mu}^{-1})$ has not.
\end{definition}
\begin{definition}\label{doublefactorial}
We define the double factorial for $ n\geq -1$ by 
$$n!! \,\coloneqq \prod_{i=0}^{\left\lfloor\!\frac{n-1}{2}\!\right\rfloor }(n-2i)=n(n-2)(n-4)\ldots $$
Clearly, $(n-1)!!\,n!! = n!$ and $(2n)!! = 2^n n!$.
\end{definition}
\begin{proposition} \label{partitioncount}
The number of partitions of the set $\{1,\ldots,2k\}$ into pairs equals $(2k-1)!! = \frac{(2k)!}{2^kk!}$.
\end{proposition}
\begin{proof}
Given such a partition, look at the pair that contains the element $1$. There are $2k-1$ possible partners for this element; removing the pair leaves a partition of a set of cardinality $(2k-2)$ into pairs. Then proceed by induction.
\end{proof}

\section{Hilbert schemes of points on surfaces}
Let $A$ be a smooth projective complex surface. Set $H:=H^*(A,\Q)$. Let $A\hilb{n}$ the Hilbert scheme of $n$ points on the surface, \ie the moduli space of finite subschemes of $A$ of length $n$.
%$$\Hilb^ n : S \mapsto \left\{ Z\subset S\times A\,|\,Z\text{ closed subscheme, } p_1 : Z\rightarrow S \text{ flat and finite of degree }n\right\}.$$
$A\hilb{n}$ is again smooth and projective of dimension $2n$. 

Their rational cohomology can be described in terms of Nakajima's operators. First consider the direct sum
$$
\H := \bigoplus_{n=0}^{\infty} H^*(A\hilb{n},\Q)
$$
This space is bigraded by cohomological \emph{degree} and the \emph{weight}, which is given by the number of points $n$. The unit element in $H^0(A\hilb{0},\Q) \cong \Q$ is denoted by $\vac$, called the \emph{vacuum}.
There are linear operators $\q_m(a)$, for each $m\geq 1$ and $a \in H^*(A,\Q)$, acting on $\H$ which have the following properties: They depend linearly on $a$, and if $a\in H^k(A,\Q)$ is homogeneous, the operator $\q_{m}(a)$ is bihomogeneous of degree $k+2(|m|-1)$ and weight $m$:
$$
\q_{m}(a) : H^l(A\hilb{n}) \rightarrow H^{l+k+2(|m|-1)}(A\hilb{n+m})
$$
To construct them, first define incidence varieties $Z_m\subset A\hilb{n}\times A\times A\hilb{n+m}$ by
$$
Z_m := \left\{(\xi,x,\xi')\, |\, \xi\subset\xi',\, \supp(\xi') -\supp(\xi) = mx \right\}.
$$
Then $\q_m(a)(\beta) $ is defined as the Poincar\'e dual of 
$$
pr_{3*}\left( \left(pr_2^*(\alpha)\cdot pr_3^*(\beta)\right) \cap [Z_m] \right).
$$
Every element in $\H$ can be decomposed uniquely as a linear combination of products of operators $\q_{m}(a)$, acting on the vacuum. 

To give the cup product structure of $\H$, define oprators $\G(a)$ for $a \in H^*(A)$. Let $\Xi_n \subset A\hilb{n}\times A$ be the universal subscheme. Then the action of $\G(a)$ on $H^*(A\hilb{n})$ is multiplication with the class
$$
pr_{1*}\left( \ch(\mathcal{O}_{\Xi_n})\cdot pr_2^*(\td(A)\cdot a) \right) \in H^*(A\hilb{n}).
$$
For $a \in H^k(A)$, we define $\G_i(a)$ to be the component of $\G(a)$ of cohomological degree $k+2i$. A differential operator $\mathfrak{d}$ is given by $\G_1(1)$. It means multiplication with the first Chern class of the tautological sheaf $pr_{1*}\left( \mathcal{O}_{\Xi_n}\right)$.

In \cite{LehnSorger} and \cite{LiQinWang} there are various commutation relations between these operators, that allow to determine all multiplications in the cohomology of the Hilbert scheme. First of all, if $X$ and $Y$ are operators of degree $d$ and $d'$, their commutator is defined as 
$$
[X,Y] := XY - (-1)^{dd'}YX.
$$
The integral on $A\hilb{n}$ induces a bilinar form on $\H$: for classes $\alpha,\,\beta\in H^*(A\hilb{n})$ it is given by
$$
(\alpha,\beta) \longmapsto \int_{A\hilb{n}}\alpha\cdot\beta.
$$
If $X$ is a homogeneous linear operator of degree $d$ and weight $m$, acting on $\H$, define its adjont $X^\dagger$ by
$$
\int_{A\hilb{n+m}}X(\alpha)\cdot\beta = (-1)^{d\deg(\alpha)}\int_{A\hilb{n}} \alpha \cdot X^\dagger (\beta).
$$
We put $\q_0(a) :=0$ and for $m<0$, $\q_m(a) := (-1)^m \q_{-m}(a)^\dagger$. Then define
$$
\mathfrak{L}_m(a) := \left\{ 
\begin{array}{ll}
 \tfrac{1}{2}\sum\limits_{k\in\Z}\sum\limits_{i}\q_k( a_{(1)})\q_{m-k}( a_{(2)}), & \text{ if } m\neq 0, \vspace{4mm}\\
 \sum\limits_{k>0}\sum\limits_{i}\q_k( a_{(1)})\q_{-k}( a_{(2)}), & \text{ if } m= 0. \\
\end{array}
\right.
$$
where $\sum_i a_{(1)}\otimes  a_{(2)}$ is the push-forward of $a$ along the diagonal $\tau_2 :A \rightarrow A\times A$ (in Sweedler notation).
Then we have (\cite[Thm.~2.16]{LiQinWang}):
\begin{align}
[\q_m(a), \q_l(b)] &= m\cdot \delta_{m+l} \cdot \int_A ab \\
[\mathfrak{L}_m(a),\q_l(b)] &= -m\cdot \q_{m+l}(ab) \\
\label{DiffNaka}
[\mathfrak{d},\q_m(a)] &= m \cdot \mathfrak{L}_m(a) + \tfrac{m(|m|-1)}{2} \q_m(K a) \\
[\G(a),\q_1(b)] &= \exp(\ad(\mathfrak{d}))(\q_1(a b) )
\end{align}
Note (cf.~\cite[Thm.~3.8]{LehnSorger}) that this implies that 
\begin{equation}\label{NakaDel}
\q_{m+1}(a) = \tfrac{(-1)^m}{m!}\ad^m([\mathfrak{d},\q_1(1)])(\q_1(a)),
\end{equation}
so there are two ways of writing an element of $\H$: As a linear combination of products of creation operators $\q_m(a)$ or as a linear combination of products of the operators $\mathfrak{d}$ and $\q_1(a)$. While the first one is more intuitive, the second one is more suitable for computing cup-products. 
Equations (\ref{DiffNaka}) and (\ref{NakaDel}) permit now to switch between the two representations, using that
\begin{gather}
\mathfrak{d} \vac = 0 ,  \\
\mathfrak{L}_m(a) \vac = \left\{ 
\begin{array}{cl}
 \tfrac{1}{2}\sum\limits_{k=1}^{m-1}\sum\limits_{i}\q_k(a_{(1)})\q_{m-k}(a_{(2)})\vac, & \text{ if } m>1, \vspace{4mm}\\
 0, & \text{ if } m\leq 1. \\
\end{array}
\right.\\
\end{gather}


\begin{remark}
We adopted the notation from \cite{LiQinWang}, which differs from the conventions in \cite{LehnSorger}. Here is part of a dictionary:

\begin{tabular}{c|c} 
Notation from \cite{LiQinWang} & Notation from \cite{LehnSorger} \\\hline
operator of bidegree $(w,d)$ & operator of bidegree $(w,d-2w)$\\
$\q_m(a) $ & $\p_{-m}(a)$ \\
$ \mathfrak{L}_m(a) $ & $ - L_{-m}(a)$ \\
$\mathfrak{G}(a)$ & $a\hilb{\bullet}$\\
$ \mathfrak{d} $ & $ \partial $ \\
$\tau_{2*}(a)$& $-\Delta(a)$
\end{tabular}
\end{remark}

By sending a subscheme in $A$ to is support, we define a morphism
$$
\rho : A\hilb{n} \longrightarrow \Sym^n(A),
$$
called the Hilbert--Chow morphism. The cohomology of $\Sym^n(A)$ is given by elements of the $n$-fold tensor power of $H^*(A)$ that are invariant under the action of the group of permutations $\mathfrak{S}_n$. A class in $H^*(A\hilb{n},\Q)$ which can be written using only the operators $\q_1$ comes from a pullback along $\rho$:
\begin{equation}
\label{qSym}
\q_1(b_1)\cdots \q_1(b_n)\vac = \rho^*\left( \sum_{\pi\in\mathfrak{S}_n } \pm b_{\pi(1)}\otimes\ldots\otimes b_{\pi(n)} \right), \quad b_i\in H^*(A,\Q),
\end{equation}
where signs arise from permuting factors of odd degrees. In particular,
\begin{gather} \label{q0primitive}
\frac{1}{n!}\q_1(b)^n \vac = \rho^*\big( b\otimes \ldots \otimes b\big),
\\ \label{q1primitive}
\frac{1}{(n-1)!}\q_1(b)\left(\q_1(1)\right)^{n-1}\vac =\rho^*\Big( b\otimes\! 1\!\otimes\ldots\otimes\! 1\; + \;\ldots\; +\; 1\!\otimes\ldots\otimes\! 1\! \otimes b\Big) .
\end{gather}
This is sometimes useful for manually computing products:
\begin{proposition}\label{qprimitivepower}
Let $b\in H^2(A,\Q)$ be of degree $2$ and set $B_n := \frac{1}{(n-1)!}\q_1(b)\left(\q_1(1)\right)^{n-1}\vac$, $Q_n:= B_n^{2n}$, $P_n :=B_n^{2n-2}$. Then:
\begin{equation*}
Q_n
%&= n! \cdot (2n-1)!! \cdot \rho^*\left(b^2 \otimes \cdots \otimes b^2\right) \\
= (2n-1)!! \cdot \q_1(b^2)^n\vac,
\quad
P_n = \q_1(1) Q_{n-1} + n\cdot \q_1(b)^2 Q_{n-2}.
\end{equation*}
\end{proposition}
\begin{proof} First note that, by (\ref{q1primitive}),
$$
B_n^k = \rho^*\left(\sum_{i_1+\ldots+i_n= k}b^{i_1}\otimes\cdots\otimes b^{i_n}\right).
$$
It is clear by degree reasons that $Q_n$ must be a multiple of $ \rho^*\left(b^2 \otimes \cdots \otimes b^2\right)$. Using Prop.~\ref{partitioncount} one deduces the formula for $Q_n$. 
The formula for $P_n$ follows in a similar manner.
\end{proof}


\section{On integral cohomology}

For the study of integral cohomology, first note that if $\alpha \in H^*(A,\Z)$ is an integral class, then $\q_{m}(\alpha) $ maps integral classes to integral classes. 
Moreover, there is the following theorem:
\begin{theorem} \cite{QinWang}
An operator is called integral if it maps integral classes in $\H$ to integral classes. The operator $\frac{1}{z_\lambda}\kq_{\lambda}(1)$ is integral. Let $\alpha \in H^2(A,\Z)$ be monodromy equivalent to a divisor. Then the operator $\mathfrak{m}_{\lambda}(\alpha)$ is integral.
\end{theorem}


\begin{remark}
If $A$ is a projective torus, then the sublattice of divisors in $H^2(A,\Z)$ (the N\'eron--Severi group) is not trivial. By \cite[Thm.~II]{Shioda}, the group of monodromy actions spans the entire automorphism group of $H^2(A,\Z)$.
Since the lattice is even and contains two copies of the hyperbolic lattice, a theorem of Eichler \cite[Prop.~3.7.3]{Scattone} states that the automorphism group of $H^2(A,\Z)$ acts transitively on classes of the same norm. So every class can be mapped to a divisor by the action of a monodromy.
\end{remark}

We set $a^{(k)} := \mathfrak{G}_k(a) (1) \in H^{\deg a + 2k}(A\hilb{n},\Q)$.

\begin{remark}
Qin and Wang \cite{QinWang} conjecture that the above theorem is valid even without any restriction on $\alpha \in H^2(A,\Z)$. The following proposition explicits this out for low degrees.
\end{remark}
\begin{proposition}
Let $(a_i) \subset H^1(A,\Z)/\text{Tors}$ and $(b_i)\subset H^2(A,\Z)/\text{Tors}$ be bases of integral cohomology (modulo torsion). Denote $a_i^*\in H^3(A,\Z)/\text{Tors}$ resp.~$b_i^*\in H^2(A,\Z)/\text{Tors}$ the elements of the dual bases. Let $x$ be the generator of $H^4(A,\Z)$. Then the classes
$\G_0(a_i)1 = \frac{1}{(n-1)!}\q_{1}(1)^{n-1}\q_{1}(a_{i})\vac$ form a basis of $H^1(A\hilb{n},\Z)/\text{Tors}$ with dual basis
$\q_1(a_i^*)\q_1(x)^{n-1}\vac$.
Moreover, the following classes form a basis of $H^2(A\hilb{n},\Z)/\text{Tors}$:
\begin{itemize}
 \item $\G_0(b_i)1=\frac{1}{(n-1)!}\q_{1}(1)^{n-1}\q_{1}(b_{i})\vac$,
 \item $\G_0(a_i)\G_0(a_j)1 = \frac{1}{(n-2)!}\q_{1}(1)^{n-2}\q_{1}(a_{i})\q_{1}(a_{j})\vac,\  i < j$,
 \item $\mathfrak{d} 1 =  \frac{1}{2(n-2)!}\q_{1}(1)^{n-2}\q_{2}(1) \vac$. We denote this class by $\delta$.
\end{itemize}
Their respective duals in $H^{2n-2}(A\hilb{n},\Z)/\text{Tors}$ are given by
\begin{itemize}
 \item $\q_{1}(b_{i}^*)\q_{1}(x)^{n-1}\vac$,
 \item $\q_{1}(a_{j}^*)\q_{1}(a_{i}^*)\q_{1}(x)^{n-2}\vac,\  i < j$,
 \item $\q_2(x)\q_{1}(x)^{n-2} \vac$.
\end{itemize}
\end{proposition}
\begin{proof} It is clear from the above theorem that these classes are all integral.
G\"ottsche's formula gives the Betti numbers of $A\hilb{n}$ in terms of the Betti numbers of $A$: $h^1(A\hilb{n}) = h^1(A)$, and $h^2(A\hilb{n}) = h^2(A)+ \frac{h^1(A)(h^1(A)-1)}{2} + 1$. It follows that we have not forgotten any classes. 

Next we have to show that the intersection matrix between these classes is in fact the identity matrix. Most of the entries can be computed easily using (\ref{qSym}). For products involving $\delta$ (this is the action of $\mathfrak{d}$) or its dual, first observe that $\mathfrak{d}\q_1(x)^m\vac = 0 $ and $ \mathfrak{L}_1(a)\q_1(x)^m\vac =0$ for every class $a$ of degree at least 1. Then compute:
\begin{gather*}
\delta \cdot\q_2(x)\q_{1}(x)^{n-2} \vac = \mathfrak{d}\q_2(x)\q_{1}(x)^{n-2} \vac = 2 \mathfrak{L}_2(x) \q_{1}(x)^{n-2} \vac = \q_{1}(x)^{n}\vac,
\\
\mathfrak{d}\q_{1}(b_{i}^*)\q_{1}(x)^{n-1}\vac =  \mathfrak{L}_1(b_i^*) \q_{1}(x)^{n-1} \vac = 0,
\\
\mathfrak{d}\q_{1}(a_{j}^*)\q_{1}(a_{i}^*)\q_{1}(x)^{n-2}\vac = \left(\mathfrak{L}_1(a_j^*) +\q_{1}(a_{j}^*)\mathfrak{d}\right)\q_{1}(a_{i}^*)\q_{1}(x)^{n-2}\vac = 
  \\ =\left(-\q_1(a_i^*)\mathfrak{L}_1(a_j^*) + \q_{1}(a_{j}^*)\mathfrak{L}_1(a_i^*)\right)\q_{1}(x)^{n-2}\vac  = 0,
\\
\G_0(b_i)\q_2(x)\q_{1}(x)^{n-2} \vac = 0, 
\\
\G_0(a_i)\G_0(a_j)\q_2(x)\q_{1}(x)^{n-2} \vac = 0.
\end{gather*}
\end{proof}

%The first $6$ classes give an injection $j : H^2(A,\Z)\rightarrow H^2(A\hilb{n},\Z)$. 

\begin{proposition}
 Let $A$ be a complex torus of dimension $2$. A basis of $H^*(A\hilb{2},\Z)$ is given by the classes 
 \begin{enumerate}\setcounter{enumi}{-1}
  \item $\frac{1}{2}\q_1(1)^2\vac$ ,
  \item $\q_1(1)\q_1(a_i)\vac$, for a basis $(a_i)\subset H^1(A,\Z)$,
  \item $\frac{1}{2}\q_2(1)\vac,\ \q_1(1)\q_1(u_i)\vac$ for a basis $(u_i)\subset H^2(A,\Z)$,
  \item $\q_2(a_i)\vac, \ \q_1(a_i)\q_1(u_j)\vac\ \q_1(1)\q_1(a^*_i)\vac$,
  \item $\q_2(u_i)\vac, \ \q_1(a_i)\q_1(a^*_j)\vac,\ \q_1(u_i)\q_1(u_k)\vac$ for $i\leq k$,
  \item $\frac{1}{2}\q_2(a^*_i)\vac, \ \q_1(a^*_i)\q_1(u_j)\vac, \q_1(x)\q_1(a_i)\vac$,
  \item $\q_2(x)\vac,\ \q_1(x)\q_1(u_i)\vac$,
  \item $\q_1(x)\q_1(a^*_i)\vac$, 
  \item $\q_1(x)^2\vac$.
 \end{enumerate}

\end{proposition}


\section{Generalized Kummer varieties}
Let $A$ be a complex projective torus of dimension $2$. Its first cohomology $H^1(A,\Z)$ is freely generated by four elements $a_1,a_2,a_3,a_4,$ corresponding to the four different circles on the torus. The cohomology ring is isomorphic to the exterior algebra:
$$
H^*(A,\Z) = \Lambda^* H^1(A,\Z).
$$
We abbreviate for the products $a_i\cdot a_j =: a_{ij}$ and $a_i\cdot a_j\cdot a_k =: a_{ijk}$. We write $a_1\cdot a_2\cdot a_3 \cdot a_4 =:x$ for the class corresponding to a point on $A$. We choose the $a_i$ such that $\int_A x = 1$. We set $a_{\overline{i}}$ for the dual class of $a_i$, \ie  $a_i\cdot a_{\overline{i}} =x$.
The bilinear form, given by $(a_{ij},a_{kl})\mapsto\int_A a_{ij}a_{kl}$ gives $H^2(A,\Z)$ the structure of a unimodular lattice, isomorphic to $U^{\oplus 3}$, three copies of the hyperbolic lattice. 

\begin{definition}
Let $A$ be a complex projective torus of dimension $2$ and $A\hilb{n}$, $n\geq 1$, the corresponding Hilbert scheme of points. Denote $\Sigma : A\hilb{n} \rightarrow A$ the summation morphism, a smooth submersion that factorizes via the Hilbert--Chow morphism $: A\hilb{n}\stackrel{\rho}{\rightarrow}\Sym^n(A)\stackrel{\sigma}{\rightarrow} A$. Then the generalized Kummer $\kum{A}{n-1}$ is defined as the fiber over $0$:
\begin{equation}\label{square}
\begin{CD}
\kum{A}{n-1} @>\theta >> A\hilb{n}\\
@VVV @VV\Sigma V\\
\{0\} @> >> A
\end{CD}
\end{equation}
\end{definition}
Our first objective is to collect some information about this pullback diagram. 

\begin{proposition}
Let $\alpha_i := \frac{1}{(n-1)!}\kq_{1}(1)^{n-1}\kq_1(a_i)\vac = \G_0(a_i)1$. The class of the Poincar\'e dual of $\kum{A}{n-1}$ in $H^4(A\hilb{n},\Z)$ is given by
$$
%\prod_{i=1}^4 \left(\tfrac{1}{2}\pone(1)^2\pone(\alpha_i)\vac\right).
\alpha_1\cdot\alpha_2\cdot\alpha_3\cdot\alpha_4.
$$ 
\end{proposition}
\begin{proof}
Since the generalized Kummer variety is the fiber over a point, its Poincar\'e dual must be the pullback of $x\in H^4(A)$ under $\Sigma$. But $\Sigma^* (x) = \Sigma^*(a_1)\cdot \Sigma^*(a_2)\cdot \Sigma^*(a_3)\cdot \Sigma^*(a_4)$, so we have to verify that $\Sigma^* (a_i) = a_i^{(0)}$. To do this, we want to use the decomposition $\Sigma = \sigma\rho$.
The pullback along $\sigma$ of a class $a\in H^1(A,\Q)$ on $H^1(\Sym^n(A),\Q) \cong H^*(A^n,\Q)^{\mathfrak{S}_n}$ is given by $a\otimes 1\otimes \cdots\otimes 1 + \ldots + 1\otimes \cdots\otimes 1\otimes a$. It follows from (\ref{q1primitive}) that $\Sigma^* (a_i) = \frac{1}{(n-1)!}\kq_{1}(1)^{n-1}\kq_1(a_i)\vac $.
\end{proof}
\begin{remark}
This allows us to better understand the morphism $\theta^*$. Since the Poincar\'e pairing is nondegenerated, $[\kum{A}{n-1}]\cdot \alpha=0$ implies $\theta^* \alpha =0$.
\end{remark}

\begin{proposition}
Let $\mathfrak{J}\subset H^*(A\hilb{n},\Q)$ be the ideal generated by $H^1(A\hilb{n})$. Then 
$$\ker \theta^* = \mathfrak{J} .$$
\end{proposition}
\begin{proof}
The inclusion "$\supset$" is clear by the above remark, so let us show the other inclusion.
Let $\mathfrak{H}$ be the operator algebra spanned by products of $\mathfrak d$ and $\q_1(a)$ for $a\in H^*(A)$. Let $\mathfrak C$ be the graded commutative algebra generated by $\q_1(a)$ for $a\in H^*(A)$. By sending $\mathfrak d$ to $1$, we define a linear map $s : \mathfrak H \rightarrow \mathfrak C$.
Let $K(x) = [\mathfrak G_0(a_1)\mathfrak G_0(a_2)\mathfrak G_0(a_3)\mathfrak G_0(a_4), x]$ be the commutator with the multiplication by $[\kum{A}{n-1}]$. Since $K(\mathfrak d)=0$, we have for all $x\in\mathfrak H$:
$$
K(x) = 0 \ \Leftrightarrow \ K(s(x)) = 0.
$$
Now the linear map $: \mathfrak C \rightarrow \mathbb H$, $x\mapsto x\vac$ is injective with image equal to $\rho^*\left((H^*(A^n,\Q)^{\mathfrak S_n})\right) \cong \Sym^n H $, so the statement follows from the following lemma.
\end{proof}
\begin{lemma}
The ring $\Sym^n H$ is a free $H$-module via the homomorphism $\sigma^*$
\end{lemma}
\begin{proof}
First consider the ring $H^{\otimes n}$ with the $\Q$-algebra morphisms $\iota : H \rightarrow H^{\otimes n}$, $\alpha \mapsto \alpha\otimes 1\otimes\cdots\otimes 1$ and $s : H^{\otimes n} \rightarrow H^{\otimes n}$, $\alpha_{(1)} \mapsto \alpha_{(1)}+\alpha_{(2)}+\ldots \alpha_{(n)}$, $\alpha_{(i)} \mapsto \alpha_{(i)}$. Then $s$ is an isomorphism and $\sigma^* = s\iota$. It is obvious that $H^{\otimes n}$ is a $\iota$-free $H$-module (with basis given by a $\Q$-basis of $H^{\otimes n-1}$). It follows that $H^{\otimes n}$ is $\sigma^*$-free, too. Now the action of $\mathfrak{S}_n$ on $H^{\otimes n}$ fixes the image of $\sigma^*$. So $\Sym^n H$ is a free $H$-module.
\end{proof}
\begin{corollary}
There is the following exact sequence:
$$
0 \longrightarrow\mathfrak{J} \longrightarrow \Sym^n H \stackrel{x\cdot}{\longrightarrow} \Sym^n H,
$$
which is obtained by tensoring the sequence 
$$
0 \longrightarrow J  \longrightarrow H \stackrel{x\cdot}{\longrightarrow} H
$$
with the free $H$-module $\Sym^n H$.
\end{corollary}

We recall Theorem 2 of \cite{Spanier}.
\begin{theorem}\label{torsion}
The cohomology of $\kum{A}{n-1}$ is torsion free. 
\end{theorem}

\begin{theorem}\cite{Beauville}
$\kum{A}{n-1}$ is a irreducible holomorphically symplectic manifold. In particular, it is simply connected and the canonical bundle is trivial.
\end{theorem}
So $H^2(\kum{A}{n-1},\Z)$ admits an integer-valued nondegenerated quadratic form (called Beauville--Bogomolov form) $q$ which gives $H^2(\kum{A}{n-1},\Z)$ the structure of a lattice isomorphic to $U^{\oplus 3}\oplus \left< -2n \right>$, for $n\geq 3$. We have the following formula for $\alpha\in H^2(\kum{A}{n-1},\Z)$:
\begin{equation} \label{fujiki}
%\int_{\kum{A}{n-1}} \alpha^{2n-2} = n\frac{(2n-2)!}{2^{n-1}(n\! - \! 1)!} q(a)^{n-1}
\int_{\kum{A}{n-1}} \alpha^{2n-2} = n\cdot(2n-3)!!\cdot q(\alpha)^{n-1}
\end{equation}


The morphism $\theta$ induces a homomorphism of graded rings
\begin{equation}
\theta^* :H^*(A\hilb{n},\Z)\longrightarrow H^*(\kum{A}{n-1},\Z).
\end{equation}

\begin{proposition} Assume $n\geq 3$. Then
$\theta^*$ is surjective on $H^2(A\hilb{n},\Z)$ with kernel $\Lambda^2H^1(A\hilb{n},\Z)$.
\end{proposition}
\begin{proof}
By \cite[Sect.~7]{Beauville}, $\theta^{\ast} : H^2(A\hilb{n},\C) \rightarrow H^2(\kum{A}{n-1},\C)$ is surjective. Because of $H^1(\kum{A}{n-1},\Z)=0$, it is clear that $\Lambda^2H^1(A\hilb{n},\Z)$ is contained in the kernel. This is a free $\Z$-module of rank $6$. But the second Betti numbers of $A\hilb{n}$ and $\kum{A}{n-1}$ are $13$ and $7$, respectively, so it must be all.  

It remains to show that $\theta^*$ is surjective for cohomology with integral coefficients, too.
The idea is to prove that the lattice structure of $\im \theta^*$ is the same as of $H^2(\kum{A}{n-1})$.
We use two formulas in \cite[pp.~8--11]{Britze}. Let $b\in H^2(A,\Z)$ and set $\alpha = \frac{1}{(n-1)!}\kq_{1}(1)^{n-1}\kq_1(b)\vac\in H^2(A\hilb{n},\Z)$. Then  
\begin{equation} 
\int_{A\hilb{n}}\alpha^{2n} = \binom{2n}{2} \frac{\int_A b^2}{n^2} \int_{\kum{A}{n-1}} \theta^* \alpha^{2n-2}
%\int_{A\hilb{3}}j(a)^6 = \frac{5}{3} \int_A a^2 \int_{\kum{A}{2}} \theta^* j(a)^4
\end{equation}
By Proposition \ref{qprimitivepower}, the left hand side of this equation equals $(2n-1)!!\cdot \left(\int_a b^2\right)^n$. By (\ref{fujiki}), the right hand side gives $(2n-1)!! \cdot \left(\int_A b^2\right) \cdot q(\alpha)^{n-1}$. So
we get
$\int_A b^2 = q(\alpha)$, giving the set of all $\alpha$ a lattice structure isomorphic to $H^2(A,\Z)$. 
Secondly, we must show that for $\delta=$ half of the exceptional divisor: $q(\theta^*\delta) = -2n$. But this follows now from Proposition 1 in \cite{Britze}.
%Remark: $\theta^*\delta$ seems to be indivisible (because of (\ref{fujiki})), but every product with $\theta^*\delta$ is divisible by 3. Indeed, the value of (\ref{fujiki}) for $\alpha=\theta^*\delta$ is 324.
\end{proof}



\section{Study of $\kum{A}{2}$}
Let us summarize our results on $\theta^*$ for the case $n=3$:
\begin{theorem}
The homomorphism $\theta^* : H^*(A\hilb{3},\Q)\rightarrow H^*(\kum{A}{2},\Q)$ of graded rings is surjective in every degree except $4$. Moreover, the image of $H^4(A\hilb{3},\Q)$ is equal to $\Sym^2(H^2(\kum{A}{2},\Q))$. 
The kernel of $\theta^*$ is the ideal generated by $H^1(A\hilb{3},\Q)$.
%Proof: look at the ranks of H^*(A\hilb{3}):
%Rank H1*H4 = 188
%Rank H1*H5 = 239
%Rank H1*H6 = 196
%Rank H1*H7 = 102
%Rank H1*H8 = 40
\end{theorem}


Now we focus on classes of cohomological degree 4.
\begin{proposition}
The classes $\theta^* \left(\p_{-2}(a_{ij})\pone(1)\vac\right) $ and $\theta^*\left( \p_{-2}(1)\pone(a_{ij})\vac\right) $ are linearly dependent.
\end{proposition}
\begin{proof}
We can compute the product of these two classes with $[ \kum{A}{2} ] $ in $H^*(A\hilb{3})$. The two results are linearly dependent. Is there a direct geometric proof?
\end{proof}

\begin{proposition}
$\theta^*\left(\p_{-3}(x)\vac\right) =0$ 
\end{proposition}
\begin{corollary}
$\theta^* \left(\p_{-2}(a_{ij})\pone(1)\vac\right) = \frac{1}{4}\theta^*\left( \p_{-2}(1)\pone(a_{ij})\vac\right) $
\end{corollary}
\begin{proof}
Let  $a_{ij}$ and $a_{kl}$ be complementary, \ie $a_{ij}a_{kl}=1$. We have $a_{kl}^{(1)} = -\frac{1}{2} \p_{-2}(a_{kl})\pone(1)\vac$. Then:
$$
\theta^*\left(a_{ij}^{(1)}\cdot a_{kl}^{(1)} \right) =
\theta^*\left(\p_{-3}(1)\vac + \frac{1}{2}\pone(x)^2\pone(1)\vac \right)
$$
But on the other hand, $\delta \cdot j(a) = \frac{1}{2} \p_{-2}(1)\pone(a_{ij})\vac+\p_{-2}(a_{ij})\pone(1)\vac$, and
$$
\theta^*\left(a_{kl}^{(1)} \cdot \delta \cdot j(a)\right) =
\theta^*\left(-3\p_{-3}(1)\vac  - 3\pone(x)^2\pone(1)\vac \right).
$$
\end{proof}
\begin{corollary}
$\theta^*\left( \delta \cdot j(a_{ij}) \right) = \theta^*\left( \frac{3}{4} \p_{-2}(1)\pone(a_{ij})\vac\right)$ is divisible by 3. \qed
\end{corollary}
\begin{proposition}
The classes $\theta^*\left(j(a_{ij})^2 - \frac{1}{3}j(a_{ij})\cdot \delta\right)$ are divisible by 2.
\end{proposition}
\begin{proof}
By \cite{QinWang}, the classes $\frac{1}{2} \pone(a_{ij})^2\pone(1)\vac - \frac{1}{2}\p_{-2}(a_{ij})\pone(1)\vac$ are integral in $H^4(A\hilb{n})$. But $j(a_{ij})^2= \pone(a_{ij})^2\pone(1)\vac $ and $\theta^*\left(\frac{1}{3}j(a_{ij})\cdot\delta\right) =\theta^*\left(\p_{-2}(a_{ij})\pone(1)\vac\right)$.
\end{proof}


\begin{proposition}\label{DelSum3}
The class $\theta^*\left(\delta^2+j(a_{12})\cdot j(a_{34})-j(a_{13})\cdot j(a_{24})+j(a_{14})\cdot j(a_{23})\right)$ is divisible by 3.
\end{proposition}
\begin{proof}
It is equal to $\theta^*\left(\p_{-3}(1)\vac -\frac{3}{2}\pone(x)\pone(1)^2\vac \right)$.
\end{proof}

\begin{proposition}\label{Pi'}
We have:
$$H^{4}(K_{2}(A),\Q)=\Sym^2 H^{2}(K_{2}(A),\Q)\oplus^{\bot} \Pi'\otimes\Q.$$
\end{proposition}
\begin{proof}
In Section 4 of \cite{HassettTschinkel}, we can find the following formula:
\begin{equation}
Z_{\tau}\cdot D_{1}\cdot D_{2}=2\cdot q(D_{1},D_{2}),
\label{ZT}
\end{equation}
for all $D_{1}$, $D_{2}$ in $H^{2}(K_{2}(A),\Z)$, $\tau\in A[3]$ and $q$ the Beauville-Bogomolov form.
It follows that $\Pi'\subset \Sym^2 H^{2}(K_{2}(A),\Z)^{\bot}$.
Since the cup-product is non-degenerated and by Proposition 4.3 of \cite{HassettTschinkel}, 
we have: 
\begin{align*}
\rk \left(\Sym^2 H^{2}(K_{2}(A),\Z) \oplus\Pi'\right)&=\rk \Sym^2 H^{2}(K_{2}(A),\Z) + \rk\Pi'\\
&=28+80\\
&= \rk H^{4}(K_{2}(A),\Z).
\end{align*}
It follows that $$H^{4}(K_{2}(A),\Q)=\Sym^2 H^{2}(K_{2}(A),\Q)\oplus^{\bot} \Pi'\otimes\Q.$$
\end{proof}

Next we look at the Chern classes of the tangent sheaves. Since the morphism $\Sigma$ from the defining pullback diagram (\ref{square}) is a submersion, the normal bundle of $\kum{A}{n-1}$ in $A\hilb{n}$ is trivial. Hence $c(\kum{A}{2}) = \theta^* c(A\hilb{3})$. Looking in \cite[Sect.~8]{Generating}, we find a general formula for Chern classes of Hilbert schemes of points on surfaces. So we deduce
\begin{align*}
c_2(A\hilb{3}) &= \left(\tfrac{3}{2} \mathfrak{q}_{*(1,1)}(1) \mathfrak{q}_1(1) -\tfrac{1}{3} \mathfrak{q}_3\right)\vac \\
 &= 10(1\hilb{\bullet}_{(4)})  -2(1\hilb{\bullet}_{(2)})^2 \\
c_4(A\hilb{3}) &= \tfrac{4}{3} \mathfrak{q}_{*(1,1,1)}( 1)\vac = 4 (1\hilb{\bullet}_{(4)})^2. 
\end{align*}

\begin{proposition}
We have:
$$c_{2}(K_{2}(A))=\theta^{*}\left(4j(a_{12})\cdot j(a_{34})-4j(a_{13})\cdot j(a_{24})+4j(a_{14})\cdot j(a_{23})-\frac{1}{3}\delta^{2}\right).$$
In particular $c_{2}(K_{2}(A))\in \Sym^2 H^{2}(K_{2}(A),\Z).$
\end{proposition}
\begin{proof}
We can write:
$$c_{2}(K_{2}(A))=a+b,$$
with $a\in \Sym^2 H^{2}(K_{2}(A),\Q)$ and $b\in \Pi'$.
First, we prove that $b=0$.
We have $c_{2}(K_{2}(A))\in \Pi'^{\bot}$ and also $a\in \Pi'^{\bot}$, it follows that 
$b\in \Pi'^{\bot}$. 
Since the cup-product is non-degenerated, it follows that $b$ is of torsion. 
Then by Theorem \ref{torsion}, $b=0$.

By (\ref{ZT}) and Proposition 5.1 of \cite{HassettTschinkel}, we can see that for all $D_{1}$ and $D_{2}$ in $H^{2}(K_{2}(A),\Z)$, we have:
$$c_{2}(K_{2}(A))\cdot D_{1}\cdot D_{2}=54\cdot q(D_{1},D_{2}),$$
where $q$ is the Beauville-Bogomolov form.
Then we can calculate that:
$$c_{2}(K_{2}(A))=\theta^{*}\left(4j(a_{12})\cdot j(a_{34})-4j(a_{13})\cdot j(a_{24})+4j(a_{14})\cdot j(a_{23})-\frac{1}{3}\delta^{2}\right).$$
\end{proof}
\begin{corollary}\label{DeltaSquare3}
The class $\theta^* \delta^2$ is divisible by 3.
\end{corollary}

\begin{proposition}
The element 
$$\theta^{*}\left(j(a_{12})\cdot j(a_{34})-j(a_{13})\cdot j(a_{24})+j(a_{14})\cdot j(a_{23})\right)$$ 
is divisible by 6. More precisely, it is equal to $6\,Y_p$ (see \cite{HassettTschinkel}).
\end{proposition}
\begin{proof}
Again by Section 4 of \cite{HassettTschinkel}, we have:
$$W=\frac{3}{8}(c_{2}(K_{2}(A))+3\theta^{*}(\delta)^2).$$
It follows:
\begin{equation}
W=\frac{3}{8}\theta^{*}\left(4j(a_{12})\cdot j(a_{34})-4j(a_{13})\cdot j(a_{24})+4j(a_{14})\cdot j(a_{23})+\frac{8}{3}\delta^{2}\right).
\label{W}
\end{equation}
It follows that 
$$\theta^{*}(j(a_{12})\cdot j(a_{34})-j(a_{13})\cdot j(a_{24})+j(a_{14})\cdot j(a_{23})).$$
is divisible by 2.
For the divisibility by 3, combine Proposition \ref{DelSum3} with Corollary \ref{DeltaSquare3}.
\end{proof}
\begin{remark}
We also have the following formulas:
\begin{align}
W &= \theta^* \left(\p_{-3}(1)\vac\right) \\
Y_p & = -\tfrac{1}{9}\, \theta^* \left( \pone(1) L_{-2}(1)\vac\right)
\end{align}
\end{remark}
Let us now look at cohomology classes of odd degree. Since $H^1(\kum{A}{2}) = H^7(\kum{A}{2}) =0$, we only need to consider the degrees 3 and 5.
\begin{proposition}
The map $\theta^* : H^*(A\hilb{3} ,\Q) \rightarrow H^*(\kum{A}{2},\Q)$ is surjective in degrees 3 and 5. 
If we set
\begin{align}
B_3 &:= \{ a_{\overline{i}}^{(0)},\; 1\leq i\leq 4\} \cup \{ a_{i}^{(1)},\; 1\leq i\leq 4\}  \\
B_5 &:= \{ a_{\overline{i}}^{(1)},\; 1\leq i\leq 4\} \cup \{ a_{i}^{(2)},\; 1\leq i\leq 4\} ,
\end{align}
then the images of $B_3$ and $B_5$ give bases of $H^3(\kum{A}{2},\Q)$ and $H^5(\kum{A}{2},\Q)$ that are orthogonal under the intersection pairing.
We have
\begin{align}
\int \theta^* \left( a_{\overline{ i}}^{(0)} \cdot  a_i^{(2)}  \right ) &= \pm \frac{3}{2} \\
\int \theta^* \left( a_i^{(1)} \cdot a_{\overline{ i}}^{(1)} \right ) &= \pm \frac{1}{2}.
\end{align}
Moreover, $a_{\overline{ i}}^{(0)}\cdot[\kum{A}{2}]$ and $\frac{2}{3} a_i^{(2)}\cdot[\kum{A}{2}]$ are integral classes. 
This implies (by Poincar\'e duality) that $\theta^* a_{\overline{ i}}^{(0)}$ and $\frac{2}{3} \theta^*a_i^{(2)} $ are integral. 

Question: Which of $\theta^*  a_i^{(1)} $ and $ \theta^*a_{\overline{ i}}^{(1)}$ is not integral?
\end{proposition}
 


\bibliographystyle{amsplain}
\begin{thebibliography}{10}

\bibitem{Beauville}
A.~Beauville, \emph{Vari\'et\'es k\"ahleriennes dont la premi\`ere classe de Chern est nulle}, 
  J. Differential geometry, 18 (1983) 755-782

\bibitem{Generating}
S.~Boissi\`ere and M.~Nieper-Wi{\ss}kirchen, \emph{Generating series in the cohomology 
  of Hilbert schemes of points on surfaces}, LMS J.~of Computation and Math.~10 (2007), 254--270 .

\bibitem{BNS}
S.~Boissi\`ere, M.~Nieper-Wi{\ss}kirchen, and A.~Sarti, \emph{Smith theory and 
  Irreducible Holomorphic Symplectic Manifolds}, Journal of Topology 6 (2013), no.~2, 361–-390.

\bibitem{Britze} 
M.~Britze, \emph{On the cohomology of generalized Kummer varieties}, (2003) 

\bibitem{HassettTschinkel}
B.~Hassett and Y.~Tschinkel, \emph{ Hodge theory and Lagrangian planes on 
  generalized Kummer fourfolds}, Moscow Math. Journal, 13, no. 1, 33--56, (2013) 
  
\bibitem{LehnSorger}
M.~Lehn and C.~Sorger, \emph{The cup product of {H}ilbert schemes for {$K3$}
  surfaces}, Invent. Math. \textbf{152} (2003), no.~2, 305--329.

\bibitem{LiQinWang}
W.~Li, Z.~Qin and W.~Wang, \emph{Vertex algebras and the cohomology ring structure of 
  Hilbert schemes of points on surfaces} (2002)

\bibitem{Markman}
E.~Markman, \emph{Integral generators for the cohomology ring of moduli spaces of
  sheaves over {P}oisson surfaces}, Adv. Math. \textbf{208} (2007), no.~2,
  622--646.

\bibitem{Markman2}
E.~Markman, \emph{Integral constraints on the monodromy group of the
  hyper{K}\"ahler resolution of a symmetric product of a {$K3$} surface},
  Internat. J. Math. \textbf{21} (2010), no.~2, 169--223.

\bibitem{Nakajima}
H.~Nakajima, \emph{Heisenberg algebra and {H}ilbert schemes of points on
  projective surfaces}, Ann. of Math. (2) \textbf{145} (1997), no.~2, 379--388.

\bibitem{QinWang}
Z.~Qin and W.~Wang, \emph{Integral operators and integral cohomology classes of
  {H}ilbert schemes}, Math. Ann. \textbf{331} (2005), no.~3, 669--692.

\bibitem{Scattone}
F.~Scattone, \emph{On the compactification of moduli spaces for algebraic K3 surfaces},
  Memoirs of the American Mathematical Society (1987), Volume 70, Number 374.

\bibitem{Shioda}
T.~Shioda, \emph{The period map of abelian surfaces}, J. Fac. S. Univ.Tokyo 25 (1978), 47--59.

\bibitem{Spanier}
E.~Spanier, 
\newblock {\em The homology of Kummer manifolds},
\newblock Proc. Amer. Math. Soc.
\newblock 7, (1956), 155-160.

\end{thebibliography}
\end{document}
